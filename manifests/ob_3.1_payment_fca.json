{
    "scripts": [
        {
            "description": "Domestic Payment consents fails when given an invalid ConsentId",
            "id": "OB-301-DOP-100000",
            "refURI": "https://openbanking.atlassian.net/wiki/spaces/DZ/pages/937984109/Domestic+Payments+v3.1#DomesticPaymentsv3.1-POST/domestic-payment-consents",
            "detail": "Checks that the resource correctly fails posting an invalid domestic payment consent.",
            "parameters": {
                "tokenRequestScope": "payments",
                "paymentType": "domestic-payment-consents",
                "consentId": "foobar",
                "postData": "$minimalDomesticPaymentConsent"
            },
            "body": "$postData",
            "uri": "/domestic-payment-consents/$consentId",
            "uriImplementation": "mandatory",
            "resource": "DomesticPayment",
            "asserts": [
                "OB3GLOAssertOn400",
                "OB3GLOFAPIHeader",
                "OB3GLOAssertContentType"
            ],
            "method": "post",
            "schemaCheck": false
        },
        {
            "description": "Checks Domestic Payment consents is AwaitingAuthorisation",
            "id": "OB-301-DOP-100100",
            "refURI": "https://openbanking.atlassian.net/wiki/spaces/DZ/pages/937984109/Domestic+Payments+v3.1#DomesticPaymentsv3.1-POST/domestic-payment-consents",
            "detail": "Check Domestic Payment consents returns in AwaitingAuthorisation.",
            "parameters": {
                "tokenRequestScope": "payments",
                "paymentType": "domestic-payment-consents",
                "postData": "$minimalDomesticPaymentConsent",
                "requestConsent": "false"
            },
            "body": "$postData",
            "uri": "/domestic-payment-consents",
            "uriImplementation": "mandatory",
            "resource": "DomesticPayment",
            "asserts": [
                "OB3GLOAssertOn201",
                "OB3GLOFAPIHeader",
                "OB3GLOAAssertConsentId"
            ],
            "keepContextOnSuccess": [
                {
                    "name": "OB-301-DOP-100100-ConsentId",
                    "value": "json.Data.ConsentId"
                }
            ],
            "method": "post",
            "schemaCheck": false
        },
        {
            "description": "Check PISP Domestic Payment funds-confirmation for none authorised status consent status",
            "id": "OB-301-DOP-100200",
            "refURI": "https://openbanking.atlassian.net/wiki/spaces/DZ/pages/937984109/Domestic+Payments+v3.1#DomesticPaymentsv3.1-GET/domestic-payment-consents/{ConsentId}/funds-confirmation",
            "detail": "Check PISP Domestic Payment funds-confirmation is not Authorised, responds with a 400 (Bad Request) and a UK.OBIE.Resource.InvalidConsentStatus error code.",
            "parameters": {
                "tokenRequestScope": "payments",
                "paymentType": "domestic-payment-consents",
                "consentId": "$OB-301-DOP-100100-ConsentId"
            },
            "uri": "/domestic-payment-consents/$consentId/funds-confirmation",
            "uriImplementation": "mandatory",
            "resource": "DomesticPayment",
            "asserts": [
                "OB3GLOAssertOn400",
                "OB3DOPAssertInvalidConsentStatus"
            ],
            "method": "get",
            "schemaCheck": false
        },
        {
            "description": "Domestic Payment consents succeeds with minimal data set with additional schema checks.",
            "id": "OB-301-DOP-100300",
            "refURI": "https://openbanking.atlassian.net/wiki/spaces/DZ/pages/937984109/Domestic+Payments+v3.1#DomesticPaymentsv3.1-POST/domestic-payment-consents",
            "detail": "Checks that the resource succeeds posting a domestic payment consents with a minimal data set and checks additional schema.",
            "parameters": {
                "tokenRequestScope": "payments",
                "paymentType": "domestic-payment-consents",
                "postData": "$minimalDomesticPaymentConsent",
                "requestConsent": "true"
            },
            "body": "$postData",
            "uri": "/domestic-payment-consents",
            "uriImplementation": "mandatory",
            "resource": "DomesticPayment",
            "asserts": [
                "OB3GLOAssertOn201",
                "OB3GLOFAPIHeader",
                "OB3DOPAssertOnAcceptedSettlementCompleted",
                "OB3GLOAAssertConsentId"
            ],
            "keepContextOnSuccess": [
                {
                    "name": "OB-301-DOP-100300-ConsentId",
                    "value": "json.Data.ConsentId"
                }
            ],
            "method": "post",
            "schemaCheck": true
        },
        {
            "description": "Check Domestic Payment default status is AwaitingAuthorisation.",
            "id": "OB-301-DOP-100400",
            "refURI": "https://openbanking.atlassian.net/wiki/spaces/DZ/pages/937984109/Domestic+Payments+v3.1#DomesticPaymentsv3.1-POST/domestic-payments",
            "detail": "Check Domestic Payment default status is AwaitingAuthorisation immediately after the domestic-payment-consent has been created.",
            "parameters": {
                "tokenRequestScope": "payments",
                "paymentType": "domestic-payment-consents",
                "consentId": "$OB-301-DOP-100300-ConsentId"
            },
            "uri": "/domestic-payment-consents/$consentId",
            "uriImplementation": "mandatory",
            "resource": "DomesticPayment",
            "asserts": [
                "OB3GLOFAPIHeader",
                "OB3GLOAssertOn200",
                "OB3DOPAssertAwaitingAuthorisation"
            ],
            "method": "get",
            "schemaCheck": false
        },
        {
            "description": "Check PISP Domestic Payment funds-confirmation for none authorised status consent status",
            "id": "OB-301-DOP-100500",
            "refURI": "https://openbanking.atlassian.net/wiki/spaces/DZ/pages/937984109/Domestic+Payments+v3.1#DomesticPaymentsv3.1-GET/domestic-payment-consents/{ConsentId}/funds-confirmation",
            "detail": "Check PISP Domestic Payment funds-confirmation is not Authorised, responds with a 400 (Bad Request) and a UK.OBIE.Resource.InvalidConsentStatus error code.",
            "parameters": {
                "tokenRequestScope": "payments",
                "paymentType": "domestic-payment-consents",
                "consentId": "$OB-301-DOP-100300-ConsentId"
            },
            "uri": "/domestic-payment-consents/$consentId/funds-confirmation",
            "uriImplementation": "mandatory",
            "resource": "DomesticPayment",
            "asserts": [
                "OB3GLOAssertOn400",
                "OB3DOPAssertInvalidConsentStatus"
            ],
            "method": "get",
            "schemaCheck": false
        },
        {
            "description": "Check post domestic-payments",
            "id": "OB-301-DOP-100600",
            "refURI": "https://openbanking.atlassian.net/wiki/spaces/DZ/pages/999623013/Domestic+Payments+v3.1.1#DomesticPaymentsv3.1.1-POST/domestic-payments",
            "detail": "Check that once the domestic-payment-consent has been authorised by the PSU, the PISP can proceed to submitting the domestic-payment for processing.",
            "parameters": {
                "tokenRequestScope": "payments",
                "paymentType": "domestic-payment",
                "consentId": "$OB-301-DOP-100300-ConsentId"
            },
            "body": "$postData",
            "uri": "/domestic-payments",
            "uriImplementation": "mandatory",
            "resource": "DomesticPayment",
            "asserts": [
                "OB3GLOAssertOn201"
            ],
            "keepContextOnSuccess": [
                {
                    "name": "OB-301-DOP-100600-DomesticPaymentId",
                    "value": "json.Data.DomesticPaymentId"
                }
            ],
            "method": "post",
            "schemaCheck": false
        },
        {
            "description": "Check PISP can retrieve the domestic-payment to check its status.",
            "id": "OB-301-DOP-100700",
            "refURI": "https://openbanking.atlassian.net/wiki/spaces/DZ/pages/999623013/Domestic+Payments+v3.1.1#DomesticPaymentsv3.1.1-GET/domestic-payments/{DomesticPaymentId}",
            "detail": "Check PISP can retrieve the domestic-payment to check its status.",
            "parameters": {
                "tokenRequestScope": "payments",
                "paymentType": "domestic-payment-consents",
                "paymentId": "&OB-301-DOP-100600-DomesticPaymentId"
            },
            "uri": "/domestic-payments/$paymentId",
            "uriImplementation": "mandatory",
            "resource": "DomesticPayment",
            "asserts": [
                "OB3GLOAssertOn200"
            ],
            "method": "get",
            "schemaCheck": false
        },
        {
            "description": "Domestic Scheduled Payment consents succeeds with minimal data set with additional schema checks.",
            "id": "OB-301-DOP-100800",
            "refURI": "https://openbanking.atlassian.net/wiki/spaces/DZ/pages/999786587/Domestic+Scheduled+Payment+v3.1.1#DomesticScheduledPaymentv3.1.1-POST/domestic-scheduled-payment-consents",
            "detail": "Checks that the resource succeeds for a PISP posting a Domestic Scheduled Payment consent with a minimal data set and checks additional schema.",
            "parameters": {
                "tokenRequestScope": "payments",
                "postData": "$minimalDomesticPaymentConsent",
                "requestConsent": "true"
            },
            "body": "$postData",
            "uri": "/domestic-scheduled-payment-consents",
            "uriImplementation": "conditional",
            "resource": "DomesticScheduledPayment",
            "asserts": [
                "OB3GLOAssertOn201",
                "OB3GLOFAPIHeader",
                "OB3DOPAssertAwaitingAuthorisation",
                "OB3GLOAAssertConsentId"
            ],
            "keepContextOnSuccess": [
                {
                    "name": "OB-301-DOP-100800-ConsentId",
                    "value": "json.Data.ConsentId"
                }
            ],
            "method": "post",
            "schemaCheck": true
        },
        {
            "description": "Check PISP can retrieve Domestic Scheduled Payment consent resource status.",
            "id": "OB-301-DOP-100900",
            "refURI": "https://openbanking.atlassian.net/wiki/spaces/DZ/pages/999786587/Domestic+Scheduled+Payment+v3.1.1#DomesticScheduledPaymentv3.1.1-GET/domestic-scheduled-payment-consents/{ConsentId}",
            "detail": "Check PISP can retrieve Domestic Scheduled Payment consent resource status is Authorised.",
            "parameters": {
                "tokenRequestScope": "payments",
                "paymentType": "domestic-payment-consents",
                "consentId": "&OB-301-DOP-100800-ConsentId"
            },
            "uri": "/domestic-scheduled-payments/$consentId",
            "uriImplementation": "conditional",
            "resource": "DomesticScheduledPayment",
            "asserts": [
                "OB3GLOAssertOn200",
                "OB3DOPAssertAuthorised"
            ],
            "method": "get",
            "schemaCheck": false
        },
        {
            "description": "Domestic Scheduled Payment succeeds with minimal data set with additional schema checks.",
            "id": "OB-301-DOP-101000",
            "refURI": "https://openbanking.atlassian.net/wiki/spaces/DZ/pages/999786587/Domestic+Scheduled+Payment+v3.1.1#DomesticScheduledPaymentv3.1.1-POST/domestic-scheduled-payments",
            "detail": "Checks that the resource succeeds posting a domestic scheduled payment with a minimal data set and checks additional schema.",
            "parameters": {
                "tokenRequestScope": "payments",
                "paymentType": "domestic-payment-consents",
                "postData": "$minimalDomesticPaymentConsent"
            },
            "body": "$postData",
            "uri": "/domestic-scheduled-payments",
            "uriImplementation": "conditional",
            "resource": "DomesticScheduledPayment",
            "asserts": [
                "OB3GLOAssertOn201"
            ],
            "keepContextOnSuccess": [
                {
                    "name": "OB-301-DOP-101000-DomesticScheduledPaymentId",
                    "value": "json.Data.DomesticScheduledPaymentId"
                }
            ],
            "method": "post",
            "schemaCheck": true
        },
        {
            "description": "Check PISP A PISP can retrieve the domestic-scheduled-payment to check its status.",
            "id": "OB-301-DOP-101100",
            "refURI": "https://openbanking.atlassian.net/wiki/spaces/DZ/pages/999786587/Domestic+Scheduled+Payment+v3.1.1#DomesticScheduledPaymentv3.1.1-GET/domestic-scheduled-payments/{DomesticScheduledPaymentId}",
            "detail": "Check PISP A PISP can retrieve the domestic-scheduled-payment to check its status InitiationPending or InitiationCompleted.",
            "parameters": {
                "tokenRequestScope": "payments",
                "paymentType": "domestic-payment-consents",
                "paymentID": "&OB-301-DOP-101000-DomesticScheduledPaymentId"
            },
            "uri": "/domestic-scheduled-payments/&OB-301-DOP-101000-DomesticScheduledPaymentId",
            "uriImplementation": "conditional",
            "resource": "DomesticScheduledPayment",
            "asserts": [
                "OB3GLOAssertOn200"
            ],
            "method": "get",
            "schemaCheck": false
        },
        {
            "description": "Domestic standing order consents succeeds with minimal data set with additional schema checks.",
            "id": "OB-301-DOP-101200",
            "refURI": "https://openbanking.atlassian.net/wiki/spaces/DZ/pages/1000670131/Domestic+Standing+Orders+v3.1.1#DomesticStandingOrdersv3.1.1-POST/domestic-standing-order-consents",
            "detail": "Checks that the resource succeeds for a PISP posting a Domestic Standing Order consent with a minimal data set and checks additional schema.",
            "parameters": {
                "tokenRequestScope": "payments",
                "postData": "$minimalDomesticPaymentConsent",
                "requestConsent": "true"
            },
            "body": "$postData",
            "uri": "/domestic-scheduled-payment-consents",
            "uriImplementation": "conditional",
            "resource": "DomesticStandingOrder",
            "asserts": [
                "OB3GLOAssertOn201",
                "OB3GLOFAPIHeader",
                "OB3GLOAAssertConsentId"
            ],
            "keepContextOnSuccess": [
                {
                    "name": "OB-301-DOP-101200-ConsentId",
                    "value": "json.Data.ConsentId"
                }
            ],
            "method": "post",
            "schemaCheck": true
        },
        {
            "description": "Check PISP can retrieve Domestic Standing Order consent resource status.",
            "id": "OB-301-DOP-101300",
            "refURI": "https://openbanking.atlassian.net/wiki/spaces/DZ/pages/999786587/Domestic+Scheduled+Payment+v3.1.1#DomesticScheduledPaymentv3.1.1-GET/domestic-scheduled-payment-consents/{ConsentId}",
            "detail": "Check PISP can retrieve Domestic Standing Order consent resource and status is Authorised.",
            "parameters": {
                "tokenRequestScope": "payments",
                "paymentType": "domestic-payment-consents",
                "consentId": "&OB-301-DOP-101200-ConsentId"
            },
            "uri": "/domestic-standing-order-consents/$consentId",
            "uriImplementation": "conditional",
            "resource": "DomesticStandingOrder",
            "asserts": [
                "OB3GLOAssertOn200",
                "OB3DOPAssertAuthorised"
            ],
            "method": "get",
            "schemaCheck": false
        },
        {
            "description": "Domestic Standing Order succeeds with minimal data set with additional schema checks.",
            "id": "OB-301-DOP-101400",
            "refURI": "https://openbanking.atlassian.net/wiki/spaces/DZ/pages/1000670131/Domestic+Standing+Orders+v3.1.1#DomesticStandingOrdersv3.1.1-POST/domestic-standing-orders",
            "detail": "Checks that the resource succeeds posting a Domestic Standing Order with a minimal data set and checks additional schema.",
            "parameters": {
                "tokenRequestScope": "payments",
                "paymentType": "domestic-payment-consents",
                "postData": "$minimalDomesticPaymentConsent"
            },
            "body": "$postData",
            "uri": "/domestic-standing-orders",
            "uriImplementation": "conditional",
            "resource": "DomesticScheduledPayment",
            "asserts": [
                "OB3GLOAssertOn201"
            ],
            "keepContextOnSuccess": [
                {
                    "name": "OB-301-DOP-101000-DomesticScheduledPaymentId",
                    "value": "json.Data.DomesticScheduledPaymentId"
                }
            ],
            "method": "post",
            "schemaCheck": true
        },
        {
            "description": "Check PISP A PISP can retrieve the Domestic Standing Order to check its status.",
            "id": "OB-301-DOP-101500",
            "refURI": "https://openbanking.atlassian.net/wiki/spaces/DZ/pages/1000670131/Domestic+Standing+Orders+v3.1.1#DomesticStandingOrdersv3.1.1-GET/domestic-standing-orders/{DomesticStandingOrderId}",
            "detail": "Check PISP A PISP can retrieve the Domestic Standing Order.",
            "parameters": {
                "tokenRequestScope": "payments",
                "paymentType": "domestic-payment-consents",
                "paymentID": "&OB-301-DOP-101000-DomesticScheduledPaymentId"
            },
            "uri": "/domestic-standing-orders/&paymentID",
            "uriImplementation": "conditional",
            "resource": "DomesticScheduledPayment",
            "asserts": [
                "OB3GLOAssertOn200"
            ],
            "method": "get",
            "schemaCheck": false
        }
    ]
}